<!doctype html>
<html lang="en">
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-8249107-7"></script>
    <script>
       window.dataLayer = window.dataLayer || [];
       function gtag(){dataLayer.push(arguments);}
       gtag('js', new Date());
       gtag('config', 'UA-8249107-7');
    </script>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <link href="css/bootstrap.min.css" rel="stylesheet">
        
    <script src="libs/jquery-3.3.1.min.js"></script>  
    
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="libs/jquery.csv.js"></script>
    
    <script type="text/javascript">   
		google.charts.load('current', {'packages':['corechart']});
		google.charts.load('current', {'packages':['table']});
		
		google.charts.setOnLoadCallback(drawChartConfs);
		google.charts.setOnLoadCallback(drawChartDepts);
		google.charts.setOnLoadCallback(drawChartProfs);
        google.charts.setOnLoadCallback(drawTablePapers);
        google.charts.setOnLoadCallback(drawTableStats);
        
		corebr_area_prefix= sessionStorage.getItem('corebr_area_prefix');
		var corebr_confs_file  = "data/" + corebr_area_prefix + "-out-confs.csv";
		var corebr_depts_file  = "data/" + corebr_area_prefix + "-out-scores.csv";
		var corebr_profs_file  = "data/" + corebr_area_prefix + "-out-profs.csv";
	    var corebr_papers_file = "data/" + corebr_area_prefix + "-out-papers.csv";
	    var corebr_stats_file  = "data/" + corebr_area_prefix + "-out-stats.csv";
	
		function drawChartConfs() {
		  $.get(corebr_confs_file, function(csvString) {
		  var arrayData = $.csv.toArrays(csvString, {onParseValue: $.csv.hooks.castToScalar});
		  var data= new google.visualization.DataTable();
		  data.addColumn('string', 'Conferences');
		  data.addColumn('number', 'Papers');
		  data.addRows(arrayData);
	  
		  var view = new google.visualization.DataView(data);
		  view.setColumns([0, 1,  
						   { calc: "stringify",
							 sourceColumn: 1,
							 type: "string",
							 role: "annotation" },
						  ]);
		  var options = { 'width': 800,
						  'height': 500,
						  'fontSize': 12,
						  'legend': { position: "none" },
						  'chartArea': {left:40, top:40, right:30,  width:'80%',height:'65%'},
						  'hAxis': { slantedText:true, slantedTextAngle:45 }, 
						  'vAxis': { gridlines: { counts: -1} },
						  'annotations': { alwaysOutside:true },
						  'titleTextStyle': { bold: false },
						  'title': 'Number of full papers with Brazilian authors in tracked conferences (2013-2017)'
						};
					   			
		  var chart = new google.visualization.ColumnChart(document.getElementById('chart_confs'));
		  chart.draw(view, options);
		  });
		}
		
		function drawChartDepts() {
		  $.get(corebr_depts_file, function(csvString) {
		  var arrayData = $.csv.toArrays(csvString, {onParseValue: $.csv.hooks.castToScalar});
		  var data= new google.visualization.DataTable();
		  data.addColumn('string', 'Departments');
		  data.addColumn('number', 'Score');
		  data.addRows(arrayData);
	  
		  var view = new google.visualization.DataView(data);
		  view.setColumns([0, 1,  
						   { calc: "stringify",
							 sourceColumn: 1,
							 type: "string",
							 role: "annotation" },
						  ]);
						  
		  var options = { 'width': 800,
						  'height': 500,
						  'fontSize': 12,
						  'legend': { position: "none" },
						  'chartArea': {left:40, top:40, right:30,  width:'80%',height:'65%'},
						  'hAxis': { slantedText:true, slantedTextAngle:45 }, 
						  'annotations': { alwaysOutside:true },
						  'titleTextStyle': { bold: false },
						  'title': 'Dept score= A + (0.66 * B) + (0.33 * C), where A= papers in top confs; B= papers in "near-the-top" confs; C= papers in other confs'
					     };
		 
		  var chart = new google.visualization.ColumnChart(document.getElementById('chart_depts'));
		  chart.draw(view, options);
		  });
		}
		
		function drawChartProfs() {
		  $.get(corebr_profs_file, function(csvString) {
		  var arrayData = $.csv.toArrays(csvString, {onParseValue: $.csv.hooks.castToScalar});
		  var data= new google.visualization.DataTable();
		  data.addColumn('string', 'Departments');
		  data.addColumn('number', 'Profs');
		  data.addRows(arrayData);
	  
		  var view = new google.visualization.DataView(data);
		  view.setColumns([0, 1,  
						   { calc: "stringify",
							 sourceColumn: 1,
							 type: "string",
							 role: "annotation" },
						  ]);
		  var options = { 'width': 800,
						  'height': 500,
						  'fontSize': 12,
						  'legend': { position: "none" },
						  'chartArea': {left:40, top:30, right:30,  width:'80%',height:'65%'},
						  'hAxis': { slantedText:true, slantedTextAngle:45 }, 
						  'annotations': { alwaysOutside:true },
						  'titleTextStyle': { bold: false },
						  'title': 'Number of faculty members with full papers in tracked conferences (2013-2017)'
						};
					   					
		  var chart = new google.visualization.ColumnChart(document.getElementById('chart_profs'));
		  chart.draw(view, options);
		  });
		}
		
		function drawTablePapers() {
		  $.get(corebr_papers_file, function(csvString) {
		  var arrayData = $.csv.toArrays(csvString, {onParseValue: $.csv.hooks.castToScalar});
		  var data= new google.visualization.DataTable();
		  data.addColumn('number', 'ID');
		  data.addColumn('number', 'Year');
		  data.addColumn('string', 'Conf');
		  data.addColumn('string', 'Title');
		  data.addColumn('string', 'Depts');
		  data.addColumn('string', 'Authors');
		  
		  data.addRows(arrayData);
	  			
		  var table = new google.visualization.Table(document.getElementById('chart_papers'));
		  
		  var formatter = new google.visualization.NumberFormat( {pattern: '####'} );
          formatter.format(data, 1); // format year
          
		  table.draw(data, {showRowNumber: false, width: '100%', height: '100%'});
		  });
		}
		
		function drawTableStats() {
		  $.get(corebr_stats_file, function(csvString) {
		  var arrayData = $.csv.toArrays(csvString, {onParseValue: $.csv.hooks.castToScalar});
		  var data= new google.visualization.DataTable();
		  data.addColumn('number', 'ID');
		  data.addColumn('string', 'Conference');
		  data.addColumn('string', 'Sponsor');
		  data.addColumn('number', 'Submitted');
		  data.addColumn('number', 'Accepted');
		  data.addColumn('number', 'Acceptance Rate');
		  data.addColumn('number', 'h5-index');
		  data.addColumn('string', 'Rank');
		  data.addColumn('number', 'Pages');
		  data.addRows(arrayData);
	  			
		  var table = new google.visualization.Table(document.getElementById('chart_stats'));
		  
		  var formatter1 = new google.visualization.ColorFormat();
          formatter1.addRange(0, 90, 'black', 'LemonChiffon');
          formatter1.format(data, 3); // Apply formatter to submitted papers
		  
          var formatter2 = new google.visualization.ColorFormat();
          formatter2.addRange(31, 100, 'black', 'LemonChiffon');
          formatter2.format(data, 5); 
		  
		  var formatter3 = new google.visualization.ColorFormat();
          formatter3.addRange(0, 19, 'black', 'LemonChiffon');
          formatter3.format(data, 6); 
		  
		  var formatter4 = new google.visualization.ColorFormat();
          formatter4.addRange(0, 9, 'black', 'LemonChiffon');
          formatter4.format(data, 8); 
		  
		  table.draw(data, {allowHtml: true, showRowNumber: false, width: '100%', height: '100%'});
		  });
		}
    </script>

  </head>

<body>


<ul class="nav nav-tabs" role="tablist">
  <li class="nav-item">
    <a class="nav-link small active" data-toggle="tab" href="#confs" role="tab">Conferences</a>
  </li>
  <li class="nav-item">
     <a class="nav-link small"  data-toggle="tab" href="#depts" role="tab">Departments</a>
  </li>
  <li class="nav-item">
    <a class="nav-link small"  data-toggle="tab" href="#profs" role="tab">Faculty</a>
  </li>
  <li class="nav-item">
    <a class="nav-link small"  data-toggle="tab" href="#papers" role="tab">Papers (2013-2017)</a>
  </li>
  <li class="nav-item">
    <a class="nav-link small"  data-toggle="tab" href="#stats" role="tab">Stats (2017)</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="confs" role="tabpanel">
       <div id="chart_confs"></div> 
  </div>

  <div class="tab-pane" id="depts" role="tabpanel">
       <div id="chart_depts"></div>
  </div>     
  <div class="tab-pane" id="profs" role="tabpanel">
       <div id="chart_profs"></div>
  </div>
  <div class="tab-pane" id="papers" role="tabpanel">
       <div id="chart_papers"></div>
  </div>
  <div class="tab-pane" id="stats" role="tabpanel">
       <div id="chart_stats"></div>
  </div>
</div>


<script src="libs/popper.min.js"> </script>  
<script src="libs/bootstrap.min.js"> </script>  
     
</body>    

</html>